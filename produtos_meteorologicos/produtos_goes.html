<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Teste de Camadas GOES - NASA GIBS</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  #map { height: 600px; width: 100%; }
  .controls {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 1000;
    background: white;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    max-width: 300px;
  }
  .controls label {
    display: block;
    margin-bottom: 5px;
  }
  .controls select {
    width: 100%;
    padding: 5px;
    margin-bottom: 10px;
  }
  .status {
    font-size: 12px;
    color: #666;
  }
</style>
</head>
<body>

<div class="controls">
  <label for="layerSelect">Testar Camadas GOES:</label>
  <select id="layerSelect">
    <option value="GOES16_ABI_L2_CMI_C13">GOES16_ABI_L2_CMI_C13</option>
    <option value="GOES19_ABI_L2_CMI_C13">GOES19_ABI_L2_CMI_C13</option>
    <option value="GOES_East_ABI_L2_CMI_C13">GOES_East_ABI_L2_CMI_C13</option>
    <option value="GOES_East_ABI_C13">GOES_East_ABI_C13</option>
    <option value="GOES16_ABI_C13">GOES16_ABI_C13</option>
    <option value="GOES19_ABI_C13">GOES19_ABI_C13</option>
    <option value="GOES_East_Infrared">GOES_East_Infrared</option>
    <option value="MODIS_Terra_CorrectedReflectance_TrueColor">MODIS Terra (Teste)</option>
  </select>
  <div class="status" id="status">Carregando...</div>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  // Criar mapa centrado na América do Sul
  var map = L.map('map').setView([-15, -60], 4);

  // Camada base OpenStreetMap
  var baseLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
  }).addTo(map);

  // Variável para armazenar a camada atual do GOES
  var currentGoesLayer = null;
  var statusDiv = document.getElementById('status');

  // Função para testar uma camada
  function testLayer(layerIdentifier) {
    // Remover a camada atual se existir
    if (currentGoesLayer) {
      map.removeLayer(currentGoesLayer);
    }

    statusDiv.textContent = 'Testando: ' + layerIdentifier;

    // Construir a URL
    var url = 'https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/' + layerIdentifier + '/default/latest/GoogleMapsCompatible_Level9/{z}/{y}/{x}.png';
    
    console.log('Testando URL:', url);

    // Criar a camada
    currentGoesLayer = L.tileLayer(url, {
      attribution: 'NASA GIBS - ' + layerIdentifier,
      maxZoom: 9,
      opacity: 0.7
    });

    // Adicionar eventos para monitorar o carregamento
    currentGoesLayer.on('loading', function() {
      statusDiv.textContent = 'Carregando: ' + layerIdentifier;
    });

    currentGoesLayer.on('load', function() {
      statusDiv.textContent = 'Sucesso: ' + layerIdentifier;
      statusDiv.style.color = 'green';
    });

    currentGoesLayer.on('tileerror', function(e) {
      statusDiv.textContent = 'Erro: ' + layerIdentifier + ' (Camada não encontrada)';
      statusDiv.style.color = 'red';
      console.error('Erro ao carregar tile:', e);
    });

    // Adicionar ao mapa
    currentGoesLayer.addTo(map);
  }

  // Event listener para o seletor de camadas
  document.getElementById('layerSelect').addEventListener('change', function(e) {
    statusDiv.style.color = '#666';
    testLayer(e.target.value);
  });

  // Testar a primeira camada
  testLayer('GOES16_ABI_L2_CMI_C13');

</script>

</body>
</html>
